<window title="GridTest" border="normal" width="100%">
<div style="font-weight:bold;">
<grid> 
  <auxhead>
   <auxheader colspan="1" label="Morningstar Revenue Data"/>
  </auxhead>
  <columns id="gridColumns">
    <column><label value="Ticker Symbol" style="font-weight:bold;"/></column>
    <column><label value="Company Name" style="font-weight:bold;"/></column>
    <column><label value="Address" style="font-weight:bold;"/></column>
    <column><label value="Sector" style="font-weight:bold;"/></column>
    <column><label value="Industry" style="font-weight:bold;"/></column>
    <column align="right"><label value="TTM Revenue" style="font-weight:bold;"/></column>
    <column align="right"><label value="TTM Revenue Growth" style="font-weight:bold;"/></column>
    <column align="right"><label value="Avg Revenue Growth" style="font-weight:bold;"/></column>
    <column align="right"><label value="Sharpe Revenue Growth" style="font-weight:bold;"/></column>
    <column align="right"><label value="Full Time Employees" style="font-weight:bold;"/></column>
  </columns>
  <rows id="tableRows"></rows>
</grid>
</div>
<zscript language="Java">
 <![CDATA[
  import java.sql.Connection;
  import java.sql.DriverManager;
  import java.sql.Statement;
  import java.sql.ResultSet;
  import java.sql.CallableStatement;
  import java.text.DecimalFormat;

  Class.forName("oracle.jdbc.OracleDriver");
  Connection conn = DriverManager.getConnection("jdbc:oracle:thin:@//localhost", "morningstar", "uptime5");
  Statement stmt = conn.createStatement();

  CallableStatement callStmt = conn.prepareCall( "{call fill_morningstar_rev_fact_tbl()}" );
  callStmt.executeUpdate();

  DecimalFormat integerFormatter = new DecimalFormat("#,###");
  DecimalFormat pctFormatter = new DecimalFormat("#,###.00%");
  DecimalFormat doubleFormatter = new DecimalFormat("#,###.##");

  ResultSet rs = stmt.executeQuery("SELECT * FROM (SELECT ticker_symbol, company_name, address, sector, industry, revenue_ttm, revenue_growth_ttm, avg_revenue_growth, sharpe_revenue_growth, full_time_employees FROM morningstar_rev_fact_table ORDER BY avg_revenue_growth DESC) WHERE avg_revenue_growth>=0.15");

  while ( rs.next() ) {
    Row myRow = new Row();
    Label tickerLbl = new Label( rs.getString(1) );
    tickerLbl.setStyle("font-weight:bold;");
    Label companyLbl = new Label( rs.getString(2) );
    companyLbl.setStyle("font-weight:bold;");
    Label addressLbl = new Label( rs.getString(3) );
    addressLbl.setStyle("font-weight:bold;");
    Label sectorLbl = new Label( rs.getString(4) );
    sectorLbl.setStyle("font-weight:bold;");
    Label industryLbl = new Label( rs.getString(5) );
    industryLbl.setStyle("font-weight:bold;");
    Label ttmLbl = new Label( integerFormatter.format(rs.getLong(6)) );
    ttmLbl.setStyle("font-weight:bold;");
    Label ttmGrLbl = new Label( pctFormatter.format(rs.getDouble(7)) );
    ttmGrLbl.setStyle("font-weight:bold;");
    Label avgLbl = new Label( pctFormatter.format(rs.getDouble(8)) );
    avgLbl.setStyle("font-weight:bold;");
    Label sharpeLbl = new Label( doubleFormatter.format(rs.getDouble(9)) );
    sharpeLbl.setStyle("font-weight:bold;");
    Label fullTimeEmpLbl = new Label( integerFormatter.format(rs.getInt(10)) );
    fullTimeEmpLbl.setStyle("font-weight:bold;");
    myRow.appendChild( tickerLbl );
    myRow.appendChild( companyLbl );
    myRow.appendChild( addressLbl );
    myRow.appendChild( sectorLbl );
    myRow.appendChild( industryLbl );
    myRow.appendChild( ttmLbl );
    myRow.appendChild( ttmGrLbl );
    myRow.appendChild( avgLbl );
    myRow.appendChild( sharpeLbl );
    myRow.appendChild( fullTimeEmpLbl );
    tableRows.appendChild( myRow ); 
  }

  rs.close();
  conn.close();
 ]]>
</zscript>
</window>
